/*! JSGestureRecognizer v0.2.0 http://paularmstrong.github.com/JSGestureRecognizer | http://paularmstrong.github.com/JSGestureRecognizer/license.html */(function(){function c(){function a(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}a(arguments[0],arguments[1])}function d(a){if(typeof document.createTouch!="undefined")return a;switch(a){case"touchstart":return"mousedown";case"touchmove":return"mousemove";case"touchend":return"mouseup";default:return a}}function e(a){if(typeof document.createTouch!="undefined")return;a.changedTouches=[{pageX:a.pageX,pageY:a.pageY}],a.touches=[{pageX:a.pageX,pageY:a.pageY}]}function f(a,b,c,d){var e=[b,b+"start",b+"end"],f=e.length,g=0,h,i;for(;g<f;g+=1){i=e[g];if(a===i)continue;if(d.__recognizers.hasOwnProperty(i)&&d.__recognizers[i].length){h=d.__recognizers[i].length;while(h){h-=1;if(d.__recognizers[i][h].touches===c)return d.__recognizers[i][h]}}}return null}function g(a){return a.replace(/\:\d+$/,"")}function h(a){return g(a.replace(/start(\:\d+)?$|end(\:\d+)?$/,""))}function i(a){var b=a.match(/\:(\d+)$/);return b&&b.length?parseInt(b[1],10):1}var a,b={};Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||window,c.concat(b.call(arguments)))};return e.prototype=this.prototype,f.prototype=new e,f}),a=function(a,b){this.target=a,this.touchCount=b,this.init()},a.prototype={timer:null,cancels:[],listeners:[],shouldFire:!1,init:function(){},_start:function(a){this.isTracking=!0,e(a),this.start(a)},_move:function(a){if(!this.isTracking)return;e(a),this.move(a)},_end:function(a){this.isTracking=!1,e(a),this.end(a)},start:function(){},move:function(){},end:function(){},invalidate:function(){this.shouldFire=!1,clearTimeout(this.timer),this.timer=null},validate:function(){this.shouldFire=!0},addListeners:function(a){var b=a.length,c=0,e,f,g;for(;c<b;c+=1)f=a[c],e=d(f),g=this["_"+f.replace(/^touch/,"")].bind(this),this.listeners.push({type:f,cb:g}),this.target.__addEventListener(e,g,!1)},fire:function(a,b,d){if(!this.shouldFire)return;var e=document.createEvent("Events"),f=d?this.name+d:this.name,g,h=0;for(g in this.target.__recognizers)if(this.target.__recognizers.hasOwnProperty(g)&&this.cancels.indexOf(g)!==-1){g=this.target.__recognizers[g],h=g.length;while(h)h-=1,g[h].recognizer.invalidate()}e.initEvent(f,!0,!0,a),c(e,b||{}),this.target.dispatchEvent(e)},removeListeners:function(){var a=this.listeners.length,b;while(a)a-=1,b=this.listeners[a],this.target.__removeEventListener(b.type,b.cb,!1)}},window.CreateRecognizer=function(d,e){function f(){}function g(a,b){Object.create?a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1}}):(f.prototype=b.prototype,a.prototype=new f,a.prototype.constructor=b)}return b[d]=function(a,b){this.target=a,this.touchCount=b<this.minTouches?this.minTouches:b,this.init(),this.addListeners(["touchstart","touchmove","touchend"])},g(b[d],a),c(b[d].prototype,e),b[d].prototype.name=d,b[d]},HTMLElement.prototype.__addEventListener=HTMLElement.prototype.addEventListener,HTMLElement.prototype.__removeEventListener=HTMLElement.prototype.removeEventListener,HTMLElement.prototype.addEventListener=function(a,c,d){var e=h(a),j=i(a),k;return a=g(a),this.__recognizers||(this.__recognizers={}),this.__recognizers.hasOwnProperty(e)||(this.__recognizers[e]=[]),this.__recognizers.hasOwnProperty(a)||(this.__recognizers[a]=[]),b.hasOwnProperty(e)&&(k=f(a,e,j,this),k?this.__recognizers[a].push({type:a,touches:j,recognizer:k.recognizer,cb:c}):this.__recognizers[a].push({type:a,touches:j,recognizer:new b[e](this,j),cb:c})),this.__addEventListener(a,c,d)},HTMLElement.prototype.removeEventListener=function(a,b,c){var d=h(a),e=i(a),j,k;a=g(a);if(this.__recognizers&&this.__recognizers.hasOwnProperty(d)){j=this.__recognizers[d].length;while(j)j-=1,k=this.__recognizers[d][j],(!b||k.cb===b)&&!f(a,d,e,this)&&(this.__recognizers[a][j].recognizer.removeListeners(),delete this.__recognizers[a][j])}return this.__removeEventListener(a,b,c)},CreateRecognizer("doubletap",{taps:0,invalidate:function(){this.shouldFire=!1,clearTimeout(this.timer),this.timer=null,this.taps=0},start:function(a){if(a.touches.length===this.touchCount)this.validate();else{this.invalidate();return}this.taps+=1;if(this.timer===null){var b=this;this.timer=setTimeout(function(){b.invalidate()},800)}},move:function(a){this.invalidate()},end:function(a){if(this.taps<2)return;(this.timer===null||this.taps>2)&&this.invalidate(),this.fire(a)}}),CreateRecognizer("longpress",{minduration:1e3,maxMove:3,timer:null,cancels:["tap"],start:function(a){a.touches.length===this.touchCount?this.validate():this.invalidate(),this.target.style.webkitUserSelect="none";var b=this;this.startPos={x:a.touches[0].pageX,y:a.touches[0].pageY},this.timer=setTimeout(function(){b.fire(a)},this.minduration)},move:function(a){var b=a.changedTouches[0];if(Math.abs(b.pageX-this.startPos.x)<this.maxMove&&Math.abs(b.pageY-this.startPos.y)<this.maxMove)return;this.invalidate()},end:function(a){this.invalidate()}});var j=CreateRecognizer("pinch",{minTouches:2,getDistance:function(a){var b=a[0],c=a[1],d=Math.sqrt(Math.pow(c.pageX-b.pageX,2)+Math.pow(c.pageY-b.pageY,2));return isNaN(d)?0:d},start:function(a){this.validate(),this.isStarted=!1},move:function(a){if(a.touches.length!==this.touchCount)return;var b=this.getDistance(a.touches);if(b===0)return;this.isStarted?this.fire(a,{distance:b,scale:b/this.startDistance}):(this.isStarted=!0,this.startDistance=b,this.fire(a,{distance:b,scale:1},"start"))},end:function(a){if(!this.isStarted||a.changedTouches.length!==this.touchCount)return;var b=this.getDistance(a.changedTouches);this.fire(a,{distance:b,scale:b/this.startDistance},"end"),this.isStarted=!1}}),k=CreateRecognizer("rotate",{rad:180/Math.PI,minTouches:2,getAngle:function(a){var b=a[0],c=a[1],d=Math.atan2(c.pageY-b.pageY,c.pageX-b.pageX)*this.rad;return isNaN(d)?0:d},start:function(){this.validate(),this.isStarted=!1},move:function(a){if(a.touches.length!==this.touchCount)return;var b=this.getAngle(a.touches);this.isStarted?this.fire(a,{angle:b-this.startAngle}):(this.isStarted=!0,this.startAngle=b,this.fire(a,{angle:b},"start"))},end:function(a){if(!this.isStarted||a.changedTouches.length!==this.touchCount)return;var b=this.getAngle(a.changedTouches);this.fire(a,{angle:b},"end"),this.isStarted=!1}});CreateRecognizer("swipe",{maxDuration:1e3,minDistance:80,start:function(a){if(a.touches.length!==this.touchCount){this.invalidate();return}var b=a.touches[0];this.startX=b.pageX,this.startY=b.pageY,this.startTime=new Date,this.horizontal=!1,this.vertical=!1,this.validate()},move:function(a){if(a.changedTouches.length<this.touchCount){this.invalidate();return}var b=a.changedTouches[0],c=b.pageX,d=b.pageY,e=new Date,f=Math.abs(c-this.startX),g=Math.abs(d-this.startY);if(e-this.startTime>this.maxDuration){this.invalidate();return}f>this.minDistance&&(this.horizontal=!0,this.validate()),g>this.minDistance&&(this.vertical=!0,this.validate()),!this.horizontal&&!this.vertical&&this.invalidate()},end:function(a){this.move(a);var b=a.changedTouches[0],c=b.pageX,d=b.pageY,e=c-this.startX,f=d-this.startY,g,h;if(this.vertical)g=f>this.minDistance?"down":"up",h=f;else if(this.horizontal)g=e>this.minDistance?"right":"left",h=e;else return;this.fire(a,{direction:g,distance:h,duration:new Date-this.startTime}),this.invalidate()}}),CreateRecognizer("tap",{start:function(a){a.touches.length===this.touchCount?this.validate():this.invalidate()},move:function(a){this.invalidate()},end:function(a){a.changedTouches.length!==this.touchCount&&this.invalidate(),this.fire(a)}})})();