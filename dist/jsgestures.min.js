/*! JSGestureRecognizer v0.1.0 http://paularmstrong.github.com/JSGestureRecognizer | http://paularmstrong.github.com/JSGestureRecognizer/license.html */(function(){function c(){function a(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}a(arguments[0],arguments[1])}function d(a,b,c){var d=[b,b+"start",b+"end"],e=d.length,f=0,g;for(;f<e;f+=1){g=d[f];if(a===g)continue;if(c.__recognizers.hasOwnProperty(g)&&c.__recognizers[g].length)return c.__recognizers[g][0]}return null}function e(a){return a.replace(/start$|end$/,"")}var a,b={};Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||window,c.concat(b.call(arguments)))};return e.prototype=this.prototype,f.prototype=new e,f}),a=function(a){this.target=a,this.init()},a.prototype={listeners:[],shouldFire:!0,init:function(){},start:function(){},move:function(){},end:function(){},addListeners:function(a){var b=a.length,c=0,d,e;for(;c<b;c+=1)d=a[c],e=this[d.replace(/^touch/,"")].bind(this),this.listeners.push({type:d,cb:e}),this.target.__addEventListener(d,e,!1)},fire:function(a,b,d){if(!this.shouldFire)return;var e=document.createEvent("Events"),f=d?this.name+d:this.name;e.initEvent(f,!0,!0,a),c(e,b||{}),this.target.dispatchEvent(e)},removeListeners:function(){var a=this.listeners.length,b;while(a)a-=1,b=this.listeners[a],this.target.__removeEventListener(b.type,b.cb,!1)}},window.CreateRecognizer=function(d,e){function f(){}function g(a,b){Object.create?a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1}}):(f.prototype=b.prototype,a.prototype=new f,a.prototype.constructor=b)}return b[d]=function(a){this.target=a,this.init(),this.addListeners(["touchstart","touchmove","touchend"])},g(b[d],a),c(b[d].prototype,e),b[d].prototype.name=d,b[d]},HTMLElement.prototype.__addEventListener=HTMLElement.prototype.addEventListener,HTMLElement.prototype.__removeEventListener=HTMLElement.prototype.removeEventListener,HTMLElement.prototype.addEventListener=function(a,c,f){var g=e(a),h;return this.__recognizers||(this.__recognizers={}),this.__recognizers.hasOwnProperty(g)||(this.__recognizers[g]=[]),this.__recognizers.hasOwnProperty(a)||(this.__recognizers[a]=[]),b.hasOwnProperty(g)&&(h=d(a,g,this),h?this.__recognizers[a].push({type:a,recognizer:h.recognizer,cb:c}):this.__recognizers[a].push({type:a,recognizer:new b[g](this),cb:c})),this.__addEventListener(a,c,f)},HTMLElement.prototype.removeEventListener=function(a,b,c){var f=e(a),g,h;if(this.__recognizers&&this.__recognizers.hasOwnProperty(f)){g=this.__recognizers[f].length;while(g)g-=1,h=this.__recognizers[f][g],(!b||h.cb===b)&&!d(a,f,this)&&(this.__recognizers[a][g].recognizer.removeListeners(),delete this.__recognizers[a][g])}return this.__removeEventListener(a,b,c)},CreateRecognizer("doubletap",{taps:0,timer:null,clear:function(){this.shouldFire=!1,this.taps=0,clearTimeout(this.timer),this.timer=null},start:function(a){if(a.touches.length===1)this.shouldFire=!0;else{this.shouldFire=!1;return}this.taps+=1;if(!this.timer){var b=this;this.timer=setTimeout(function(){this.clear()}.bind(this),600)}},move:function(a){this.clear()},end:function(a){if(this.taps<2)return;if(!this.timer){this.shouldFire=!1,this.taps=0;return}this.fire(a),this.shouldFire&&this.clear()}});var f=CreateRecognizer("pinch",{getDistance:function(a){var b=a[0],c=a[1],d=Math.sqrt(Math.pow(c.pageX-b.pageX,2)+Math.pow(c.pageY-b.pageY,2));return isNaN(d)?0:d},start:function(a){this.shouldFire=!0,this.isStarted=!1},move:function(a){if(a.touches.length!==2)return;var b=this.getDistance(a.touches);if(b===0)return;this.isStarted?this.fire(a,{distance:b,scale:b/this.startDistance}):(this.isStarted=!0,this.startDistance=b,this.fire(a,{distance:b,scale:1},"start"))},end:function(a){if(!this.isStarted||a.changedTouches.length!==2)return;var b=this.getDistance(a.changedTouches);this.fire(a,{distance:b,scale:b/this.startDistance},"end"),this.isStarted=!1}}),g=CreateRecognizer("rotate",{rad:180/Math.PI,getAngle:function(a){var b=a[0],c=a[1],d=Math.atan2(c.pageY-b.pageY,c.pageX-b.pageX)*this.rad;return isNaN(d)?0:d},start:function(){this.shouldFire=!0,this.isStarted=!1},move:function(a){if(a.touches.length!==2)return;var b=this.getAngle(a.touches);this.isStarted?this.fire(a,{angle:b-this.startAngle}):(this.isStarted=!0,this.startAngle=b,this.fire(a,{angle:b},"start"))},end:function(a){if(!this.isStarted||a.changedTouches.length!==2)return;var b=this.getAngle(a.changedTouches);this.fire(a,{angle:b},"end"),this.isStarted=!1}});CreateRecognizer("swipe",{maxDuration:1e3,minDistance:80,start:function(a){if(a.changedTouches.length>1){this.shouldFire=!1;return}var b=a.changedTouches[0];this.startX=b.pageX,this.startY=b.pageY,this.startTime=new Date,this.horizontal=!1,this.vertical=!1,this.shouldFire=!0},move:function(a){if(a.changedTouches.length>1){this.shouldFire=!1;return}var b=a.changedTouches[0],c=b.pageX,d=b.pageY,e=new Date,f=Math.abs(c-this.startX),g=Math.abs(d-this.startY);if(e-this.startTime>this.maxDuration){this.shouldFire=!1;return}f>this.minDistance&&(this.horizontal=!0,this.shouldFire=!0),g>this.minDistance&&(this.vertical=!0,this.shouldFire=!0),!this.horizontal&&!this.vertical&&(this.shouldFire=!1)},end:function(a){this.move(a);var b=a.changedTouches[0],c=b.pageX,d=b.pageY,e=c-this.startX,f=d-this.startY,g,h;if(this.vertical)g=Math.abs(f)>this.minDistance?"down":"up",h=f;else if(this.horizontal)g=Math.abs(e)>this.minDistance?"right":"left",h=e;else return;this.fire(a,{direction:g,distance:h,duration:new Date-this.startTime}),this.shouldFire=!1}}),CreateRecognizer("tap",{start:function(a){a.touches.length===1?this.shouldFire=!0:this.shouldFire=!1},move:function(a){this.shouldFire=!1},end:function(a){a.changedTouches.length!==1&&(this.shouldFire=!1),this.fire(a)}})})();